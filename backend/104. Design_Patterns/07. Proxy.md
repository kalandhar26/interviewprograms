## Proxy Pattern

- Proxy pattern acts as a placeholder for another object to control access (like a bank proxy card).
- The Proxy pattern provides a surrogate or placeholder for another object to control access to it.
- Itâ€™s a structural pattern that can be used for lazy initialization, access control, logging, caching, etc.

## PseudoCode

```text
1. create a subject interface. (Common to Real Object and Proxy Object)
2. Create Real Object ( The actual class that does the real work)
3. Create Proxy class which implements the same interface
    - It holds the reference to RealObject.
    - It decides whether to create / call the Real Object or do extra work.
4. Client uses the proxy - it does not know if it is talking to real object or proxy object.
```

===================

## Scenario

- Secure Account Balance Access
- A customer cannot directly access the core banking system
- Access must go through:Authentication, Authorization, Logging, xRate-limiting
- So instead of directly calling the CoreBankAccount, the client talks to a ProxyAccountService.
- All account operations must go through security, audit, and access checks before touching core banking systems.
  Proxy Pattern enforces this without modifying core logic.


## Example 1

```java
// Subject Interface
interface AccountService {
    void viewBalance(String userRole);
}

// Real Object (Core Banking System)
class CoreBankAccountService implements AccountService {

    public void viewBalance(String userRole) {
        System.out.println("Fetching balance from Core Banking System");
    }
}


// Proxy Class
class SecureAccountProxy implements AccountService {

    private CoreBankAccountService realService;

    public void viewBalance(String userRole) {

        // Access control
        if (!"CUSTOMER".equals(userRole)) {
            System.out.println("Access Denied: Unauthorized role");
            return;
        }

        // Lazy initialization
        if (realService == null) {
            realService = new CoreBankAccountService();
        }

        // Logging
        System.out.println("Audit Log: Balance accessed");

        realService.viewBalance(userRole);
    }
}


// Client
public class BankingProxyDemo {
    public static void main(String[] args) {

        AccountService account = new SecureAccountProxy();

        account.viewBalance("CUSTOMER"); // allowed
        account.viewBalance("GUEST");    // denied
    }
}

```

- output

```text
Audit Log: Balance accessed
Fetching balance from Core Banking System
Access Denied: Unauthorized role
```
===================

## Example 2

```java
interface Image {
    void display();
}

class RealImage implements Image {
    private final String file;

    RealImage(String f) {
        this.file = f;
        load();
    }

    private void load() {
        System.out.println("Loading " + file);
    }

    public void display() {
        System.out.println("Displaying " + file);
    }
}

class ProxyImage implements Image {
    private final String file;
    private RealImage real;

    ProxyImage(String f) {
        this.file = f;
    }

    public void display() {
        if (real == null) real = new RealImage(file);
        real.display();
    }
}

class ProxyDemo {
    static void run() {
        Image img = new ProxyImage("big.jpg");
        System.out.println("Proxy created");
        img.display();   // loads & shows
        img.display();   // shows from cache
    }
}
```